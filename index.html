<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard SOP Internal BPS</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
/* ===== TEMA WARNA BPS ===== */
:root{
  --primary:#1E3A8A;        /* Biru tua BPS */
  --primary-soft:#DBEAFE;   /* Biru muda */
  --accent:#F59E0B;         /* Oranye aksen */
}

body{
  margin:0;
  font-family:"Segoe UI",system-ui,sans-serif;
  background:linear-gradient(135deg,#f8fafc,#eef2f7);
  color:#1f2937;
}

header{
  background:linear-gradient(135deg,#1E3A8A,#2563EB);
  padding:20px 28px;
  box-shadow:0 8px 20px rgba(30,58,138,.35);
}
header h1{
  margin:0;
  color:#fff;
  font-size:20px;
  text-align:center;
}

nav{
  background:rgba(255,255,255,.9);
  backdrop-filter:blur(8px);
  padding:12px 24px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  border-bottom:1px solid #e5e7eb;
}
nav button{
  background:var(--primary);
  color:#fff;
  border:none;
  padding:8px 14px;
  border-radius:10px;
  cursor:pointer;
  font-weight:600;
}

main{padding:28px}

/* DASHBOARD GRID */
.dashboard{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
  gap:24px;
}
.card{
  background:rgba(255,255,255,.78);
  backdrop-filter:blur(12px);
  border-radius:18px;
  padding:20px;
  box-shadow:0 12px 30px rgba(30,58,138,.18);
}
.total-box{
  margin-top:14px;
  padding:14px 16px;
  background:linear-gradient(135deg,#fff,var(--primary-soft));
  border-radius:14px;
  display:flex;
  gap:14px;
  border-left:5px solid var(--primary);
}
.total-box i{
  font-size:28px;
  color:var(--primary);
}
.total-box strong{
  font-size:26px;
  color:var(--primary);
}

/* SOP LIST */
.sop-card{margin-top:36px}
.sop-card input{
  width:100%;
  padding:12px 14px;
  margin-bottom:14px;
  border-radius:12px;
  border:1px solid #c7d2fe;
}
.sop-card ul{
  list-style:none;
  padding:0;
  margin:0;
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
  gap:12px;
}
.sop-card li{
  background:#fff;
  border-radius:14px;
  box-shadow:0 6px 18px rgba(30,58,138,.12);
  padding:14px 16px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.sop-card a{
  text-decoration:none;
  color:#1f2937;
  font-weight:500;
}
.pin{
  cursor:pointer;
  color:var(--accent);
  font-size:18px;
}
.pinned{
  border-left:5px solid var(--accent);
}

footer{
  margin-top:36px;
  text-align:center;
  padding:14px;
  background:#1E3A8A;
  color:#e5e7eb;
}
.app-header{
  background:linear-gradient(135deg,#1E3A8A,#2563EB);
  padding:24px 16px 28px;
  text-align:center;
  box-shadow:0 8px 20px rgba(30,58,138,.35);
}

.logo-bps{
  height:150px;
  margin-bottom:10px;
}

.app-header h1{
  margin:0;
  color:#fff;
  font-size:22px;
  font-weight:600;
}

.app-header .subtitle{
  margin:4px 0 0;
  color:#DBEAFE;
  font-size:25px;
  letter-spacing:.3px;
}

</style>
</head>

<body>

<header class="app-header">
  <img src="https://lh3.googleusercontent.com/d/1FmC7IA0IFPIagwnYJlj7m9VkNZEdFkMJ=s300"
    alt="Logo BPS"
    class="logo-bps"
  >
  <h1>Dashboard SOP</h1>
  <p class="subtitle">Badan Pusat Statistik Kabupaten Belitung</p>
</header>

<nav>
  <span>Monitoring & Akses SOP Internal</span>
  <div style="display:flex;gap:10px">
    <button onclick="resetPin()">
      <i class="fas fa-rotate-left"></i> Reset PIN
    </button>
    <button onclick="toggleFullscreen()">
      <i class="fas fa-expand"></i> Fullscreen
    </button>
  </div>
</nav>

<main>

<div class="dashboard">
  <div class="card">
    <h3>SOP 2024</h3>
    <canvas id="chart2024"></canvas>
    <div class="total-box">
      <i class="fas fa-folder"></i>
      <div>Total SOP 2024<br><strong id="t2024">0</strong></div>
    </div>
  </div>

  <div class="card">
    <h3>SOP 2025</h3>
    <canvas id="chart2025"></canvas>
    <div class="total-box">
      <i class="fas fa-folder"></i>
      <div>Total SOP 2025<br><strong id="t2025">0</strong></div>
    </div>
  </div>

  <div class="card">
    <h3>Reviu SOP Terakhir</h3>
    <canvas id="chartReview"></canvas>
  </div>
</div>

<div class="card sop-card">
  <h3>Daftar SOP</h3>
  <input type="text" id="search" placeholder="Cari SOP...">
  <ul id="sopList"></ul>
</div>

</main>

<footer>
  &copy; 2025 Dashboard SOP Internal BPS
</footer>

<script>
/* FULLSCREEN */
function toggleFullscreen(){
  if(!document.fullscreenElement){
    document.documentElement.requestFullscreen();
  }else{document.exitFullscreen();}
}

/* SOP DATA */
const sopData=[
 ["SOP Subbagian Umum","1-IUCSTpL51dPP_FcJ0dTtxQGLV8eDprA"],
 ["SOP Statistik Sosial","1rZ7Yav6m7tbceBPvvXB3Yuv6wj5DGD-q"],
 ["SOP Statistik Distribusi, Keuangan, TI dan Pariwisata","1nBAoEb8iSNyCSnTIL0o8bEjdrqhUPJu-"],
 ["SOP Statistik Produksi","1HczIHHUoFTJvFIIJGQZ5JZAiJsdMuowx"],
 ["SOP Pengolahan, TI dan Diseminasi Statistik","1BIB2_IiE1yCRY2JcK6JIfA2y3nPzMKhx"],
 ["SOP Neraca Wilayah dan Analisis Statistik dan Penjaminan Kualitas","1zvBZKoC_lwnFHKTU9qF4Fl-2Fyds91ca"],
 ["SOP Sensus, Manajemen Lapangan dan Mitra","1pvszV6YlxsJEv4QBwOknXtEEwcL-bWgv"],
 ["SOP Hubungan Masyarakat","1LsHQj8pJ4bw83eNBVjg_NpNsasRoACvK"],
 ["SOP Pembinaan Statistik Sektoral","1f4WSZbPg1ZTy75FJStSYkfrrzazKaKsd"],
 ["SOP Tim Reformasi Birokrasi","1pTrCWkc4ZwsfEARjaGXFAjV7RYDsUi3k"],
 ["SOP Inovasi","1nqoscA7fjLpKKkEbGaDpb1MRWni4Uj8E"]
];

/* DEFAULT PIN INTERNAL */
const defaultPinned=[
  "SOP Subbagian Umum",
  "SOP Tim Reformasi Birokrasi",
  "SOP Inovasi"
];

let pinned=JSON.parse(localStorage.getItem("pinned"));
if(!pinned){
  pinned=[...defaultPinned];
  localStorage.setItem("pinned",JSON.stringify(pinned));
}

const list=document.getElementById("sopList");

/* RENDER SOP */
function render(filter=""){
  list.innerHTML="";
  sopData.forEach(([name,id])=>{
    if(!name.toLowerCase().includes(filter))return;
    const li=document.createElement("li");
    if(pinned.includes(name))li.classList.add("pinned");
    li.innerHTML=`
      <a href="https://drive.google.com/drive/folders/${id}" target="_blank">
        <i class="fas fa-file-alt"></i> ${name}
      </a>
      <i class="fas fa-star pin"></i>`;
    li.querySelector(".pin").onclick=()=>{
      const i=pinned.indexOf(name);
      i>-1?pinned.splice(i,1):pinned.push(name);
      localStorage.setItem("pinned",JSON.stringify(pinned));
      render(filter);
    };
    list.appendChild(li);
  });
}
render();
search.oninput=e=>render(e.target.value.toLowerCase());

/* RESET PIN */
function resetPin(){
  if(confirm("Reset PIN SOP ke default internal BPS?")){
    pinned=[...defaultPinned];
    localStorage.setItem("pinned",JSON.stringify(pinned));
    render(search.value.toLowerCase());
  }
}

/* CHART 3D EFFECT */
const shadow={id:'s',beforeDraw:c=>{
  const x=c.ctx;x.save();
  x.shadowColor='rgba(0,0,0,.3)';
  x.shadowBlur=10;
  x.shadowOffsetX=4;
  x.shadowOffsetY=4;
},afterDraw:c=>c.ctx.restore()};

fetch("https://docs.google.com/spreadsheets/d/1_nR6wRHOXv_9StDwur2fDVcd23jiFaENtMV9UieWzjk/edit?gid=0#gid=0")
.then(r=>r.text()).then(csv=>{
  const r=csv.trim().split("\n").slice(1).map(x=>x.split(","));
  const cleanLabel = v =>
  String(v || "")
    .replace(/"/g,"")
    .replace(/\n/g," ")
    .trim();
const l = r.map(x => cleanLabel(x[0]));
 const toNumber = v =>
  parseFloat(
    String(v || "0")
      .replace(/\./g, "")
      .replace(",", ".")
  ) || 0;

const d24 = r.map(x => toNumber(x[1]));
const d25 = r.map(x => toNumber(x[2]));


  t2024.innerText=d24.reduce((a,b)=>a+b,0);
  t2025.innerText=d25.reduce((a,b)=>a+b,0);

  new Chart(chart2024,{
    type:'bar',
    plugins:[shadow],
    data:{labels:l,datasets:[{data:d24,backgroundColor:'#1E40AF'}]},
    options:{plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}}
  });

  new Chart(chart2025,{
    type:'bar',
    plugins:[shadow],
    data:{labels:l,datasets:[{data:d25,backgroundColor:'#2563EB'}]},
    options:{plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}}
  });

  new Chart(chartReview,{
    type:'bar',
    plugins:[shadow],
    data:{
      labels:['Disetujui','Revisi','Kadaluarsa'],
      datasets:[{data:[12,4,2],backgroundColor:['#22C55E','#F59E0B','#EF4444']}]
    },
    options:{plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}}
  });
});
</script>

</body>
</html>


